
<h2 class="text-center mt-5">Modifier la recette : <%= @recipe.name %></h2>
<div class="row justify-content-center">
  <div class="col-sm-11 col-md-10 col-lg-6 mb-5">
    <%= render "form", recipe: @recipe %>
  </div>
</div>

<div class="d-flex flex-column align-items-center mb-5">
  <h3>Préparations associées à la recette :</h3>
  <% if @recipe.preparations.any? %>
    <ul>
      <% @recipe.preparations.order(id: :asc).each do |preparation| %>
        <li>
          <p><%= preparation.quantity %> <%= Ingredient.find(preparation.ingredient_id).unit %> <%= Ingredient.find(preparation.ingredient_id).name %></p>
          <%= link_to "Supprimer",
            recipe_preparation_path(preparation),
            method: :delete,
            class: "text-danger",
            data: { confirm: "Supprimer cette préparation ?" } %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>Aucune préparation n'est encore associée à cette recette.</p>
  <% end %>

</div>

<div class="d-flex justify-content-center align-items-baseline">
  <div class="d-flex mr-5 flex-column justify-content-center">
    <h3>Ajouter une préparation</h3>
    <%= simple_form_for (@preparation), url: recipe_preparations_path(@recipe) do |f| %>
      <%= f.input :quantity %>
      <%= f.association :ingredient, input_html: { class: 'select2' } %>
      <%= f.submit "Enregistrer", class: "btn btn-success"%>
    <% end %>
  </div>
  <div class="d-flex ml-5 flex-column justify-content-center">
    <h3>Enregistrer un nouvel ingrédient</h3>
    <%= simple_form_for @ingredient, url: ingredients_path(recipe_id: @recipe.id) do |f| %>
      <%= f.input :name %>
      <%= f.input :unit, collection: Ingredient::UNIT, input_html: { class: 'select2' } %>
      <%= f.input :category, collection: Ingredient::CATEGORY, input_html: { class: 'select2' }  %>
      <%= f.submit "Enregistrer", class: "btn btn-success"%>
    <% end %>
  </div>
</div>

<div class="text-center m-5">
<%= link_to "Retourner aux recettes", recipes_path, class: "btn btn-primary"  %>
</div>